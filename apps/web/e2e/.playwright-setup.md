# Playwright MCP Configuration

> **Status:** âœ… Configured for MCP Integration  
> **Last Updated:** 2025-12-16

---

## ğŸ“‹ Configuration Overview

Playwright has been configured for MCP (Model Context Protocol) integration with the following features:

### âœ… Configuration Features

1. **Multi-Browser Support**
   - Chromium (Desktop Chrome)
   - Firefox (Desktop Firefox)
   - WebKit (Desktop Safari)
   - Mobile Chrome (Pixel 5)

2. **Test Artifacts**
   - HTML reports: `playwright-report/`
   - JSON results: `test-results/results.json`
   - Screenshots: On failure only
   - Videos: Retained on failure
   - Traces: On first retry

3. **MCP-Friendly Settings**
   - Headless mode configurable via environment
   - Viewport: 1280x720 (standard)
   - Action timeout: 10s
   - Navigation timeout: 30s
   - Test timeout: 30s

4. **Dev Server Integration**
   - Auto-starts Next.js dev server
   - Reuses existing server (non-CI)
   - Timeout: 120s

---

## ğŸš€ Usage

### Run All E2E Tests
```bash
cd apps/web
pnpm test:e2e
```

### Run with UI Mode
```bash
pnpm test:e2e:ui
```

### Run in Headed Mode (see browser)
```bash
pnpm test:e2e:headed
```

### Debug Tests
```bash
pnpm test:e2e:debug
```

### Run Specific Test File
```bash
npx playwright test e2e/ap01-vendor-master.spec.ts
```

### Run Specific Browser
```bash
npx playwright test --project=chromium
```

---

## ğŸ”§ MCP Integration

### Available MCP Tools

The Playwright MCP server provides the following tools:

1. **Navigation**
   - `playwright_navigate` - Navigate to URL
   - `playwright_go_back` - Navigate back
   - `playwright_go_forward` - Navigate forward

2. **Interaction**
   - `playwright_click` - Click element
   - `playwright_fill` - Fill input field
   - `playwright_select` - Select dropdown option
   - `playwright_hover` - Hover element
   - `playwright_press_key` - Press keyboard key
   - `playwright_drag` - Drag and drop

3. **Screenshots & Media**
   - `playwright_screenshot` - Take screenshot
   - `playwright_save_as_pdf` - Save page as PDF

4. **Information**
   - `playwright_get_visible_text` - Get page text
   - `playwright_get_visible_html` - Get page HTML
   - `playwright_console_logs` - Get console logs
   - `playwright_evaluate` - Execute JavaScript

5. **Browser Control**
   - `playwright_resize` - Resize viewport
   - `playwright_close` - Close browser
   - `playwright_custom_user_agent` - Set user agent

6. **HTTP Requests**
   - `playwright_get` - HTTP GET
   - `playwright_post` - HTTP POST
   - `playwright_put` - HTTP PUT
   - `playwright_patch` - HTTP PATCH
   - `playwright_delete` - HTTP DELETE

7. **Testing**
   - `playwright_expect_response` - Wait for HTTP response
   - `playwright_assert_response` - Assert response

---

## ğŸ“ Directory Structure

```
apps/web/
â”œâ”€â”€ playwright.config.ts          # Main configuration
â”œâ”€â”€ e2e/                           # Test files
â”‚   â”œâ”€â”€ ap01-vendor-master.spec.ts
â”‚   â””â”€â”€ phase3-meta-registry.spec.ts
â”œâ”€â”€ playwright-report/             # HTML reports (generated)
â”œâ”€â”€ test-results/                  # Test artifacts (generated)
â”‚   â”œâ”€â”€ results.json
â”‚   â””â”€â”€ [screenshots, videos, traces]
â””â”€â”€ .playwright-setup.md           # This file
```

---

## ğŸ¯ Test Configuration Details

### Base URL
- **Default:** `http://localhost:3002`
- **Override:** Set `NEXT_PUBLIC_APP_URL` environment variable

### Timeouts
- **Test timeout:** 30 seconds
- **Action timeout:** 10 seconds
- **Navigation timeout:** 30 seconds
- **Expect timeout:** 5 seconds

### Parallel Execution
- **Local:** Fully parallel (all workers)
- **CI:** Single worker (sequential)

### Retries
- **Local:** 0 retries
- **CI:** 2 retries

---

## ğŸ” Debugging

### View Test Report
```bash
npx playwright show-report
```

### Debug Single Test
```bash
npx playwright test e2e/ap01-vendor-master.spec.ts --debug
```

### Run with Trace Viewer
```bash
npx playwright test --trace on
npx playwright show-trace
```

### Console Logs
Tests automatically capture console logs. View in:
- Test output (verbose mode)
- HTML report
- JSON results

---

## ğŸ“Š Test Results

### View HTML Report
After running tests, open:
```
apps/web/playwright-report/index.html
```

### JSON Results
Located at:
```
apps/web/test-results/results.json
```

---

## ğŸ› Troubleshooting

### Dev Server Not Starting
- Check if port 3002 is available
- Verify `pnpm dev` works manually
- Check `webServer.timeout` in config

### Tests Timing Out
- Increase `timeout` in config
- Check network connectivity
- Verify base URL is correct

### Browser Not Installing
```bash
npx playwright install
npx playwright install chromium  # Specific browser
```

### MCP Tools Not Working
- Ensure Playwright MCP server is running
- Check MCP server configuration
- Verify browser is installed

---

## ğŸ“ Best Practices

1. **Use Data Test IDs**
   ```typescript
   page.locator('[data-testid="vendor-list"]')
   ```

2. **Wait for Elements**
   ```typescript
   await page.waitForSelector('[data-testid="vendor-list"]')
   ```

3. **Use Page Object Model**
   - Create page objects for reusable selectors
   - Keep tests focused on behavior

4. **Clean Up**
   - Use `test.afterEach` for cleanup
   - Clear cookies/localStorage if needed

5. **Isolate Tests**
   - Each test should be independent
   - Use unique test data

---

## ğŸ”— Related Documentation

- [Playwright Documentation](https://playwright.dev)
- [MCP Playwright Server](https://github.com/modelcontextprotocol/servers)
- [Next.js Testing Guide](https://nextjs.org/docs/app/building-your-application/testing)

---

**Configuration Status:** âœ… Ready for MCP Integration  
**Last Verified:** 2025-12-16
