---
description: File Access Control - src/ Only Write Access
globs: ["**/*"]
alwaysApply: true
---

> **üî¥ [CRITICAL]** ‚Äî File Access Control Enforcer  
> **Purpose:** Lock all directories except `src/` - read-only enforcement  
> **Scope:** ALL files and directories  
> **Always Apply:** Yes

---

# File Access Control Rules

## üîí CRITICAL RESTRICTION

**ONLY `src/` directory is writable. ALL other directories are READ-ONLY.**

## ‚úÖ Allowed Write Access

**ONLY this directory:**
```
C:\AI-BOS\AI-BOS-Finance\src\
```

**What can be edited:**
- ‚úÖ All files in `src/` and subdirectories
- ‚úÖ Components, hooks, modules, styles, etc. in `src/`
- ‚úÖ Any file path starting with `src/`

## üî¥ FORBIDDEN Write Access

**ALL other directories are PROHIBITED:**

### ‚ùå Governance Directories (READ-ONLY)
- ‚ùå `canon/` - **FORBIDDEN** - Use `.staging-docs/` workflow
- ‚ùå `canon-pages/` - **FORBIDDEN** - Use promotion workflow
- ‚ùå `.cursor/` - **FORBIDDEN** - Configuration only
- ‚ùå `.staging-docs/` - **FORBIDDEN** - Use promotion tool

### ‚ùå Application Directories (READ-ONLY)
- ‚ùå `app/` - **FORBIDDEN** - Routes are locked
- ‚ùå `public/` - **FORBIDDEN** - Static assets only
- ‚ùå `db/` - **FORBIDDEN** - Database schemas locked

### ‚ùå Configuration Files (READ-ONLY)
- ‚ùå `package.json` - **FORBIDDEN**
- ‚ùå `tsconfig.json` - **FORBIDDEN**
- ‚ùå `next.config.mjs` - **FORBIDDEN**
- ‚ùå `tailwind.config.js` - **FORBIDDEN**
- ‚ùå `*.config.*` - **FORBIDDEN**

### ‚ùå Root Files (READ-ONLY)
- ‚ùå `README.md` - **FORBIDDEN**
- ‚ùå `.gitignore` - **FORBIDDEN**
- ‚ùå Any file at project root - **FORBIDDEN**

## üö® Enforcement Rules

### Rule 1: Path Validation
```typescript
// ‚úÖ ALLOWED
const allowedPath = 'src/components/MyComponent.tsx';
const allowedPath2 = 'src/modules/payment/hooks/usePayment.ts';

// ‚ùå FORBIDDEN
const forbiddenPath = 'app/page.tsx';
const forbiddenPath2 = 'canon/A-Governance/ADR_003.md';
const forbiddenPath3 = 'package.json';
```

### Rule 2: Write Operation Check
**Before ANY file write operation:**
1. ‚úÖ Check if path starts with `src/`
2. ‚ùå If NOT in `src/`, **REJECT** with error
3. ‚úÖ Log violation attempt

### Rule 3: MCP Server Restrictions
**All MCP servers MUST respect this:**
- Filesystem MCP: Only allow writes to `src/`
- Next.js MCP: Only allow edits in `src/`
- Git MCP: Block commits that modify non-`src/` files

## üìã Validation Checklist

Before allowing ANY file write:

- [ ] ‚úÖ Path starts with `src/`
- [ ] ‚ùå Path does NOT start with `canon/`
- [ ] ‚ùå Path does NOT start with `app/`
- [ ] ‚ùå Path does NOT start with `canon-pages/`
- [ ] ‚ùå Path is NOT at project root
- [ ] ‚ùå Path is NOT a config file

## üîß Workarounds for Locked Directories

### For Canon Files
**Use staging workflow:**
1. Create in `.staging-docs/` (allowed for staging)
2. Review and approve
3. Run: `npm run canon:promote <file-path>`

### For App Routes
**Modify `src/` components instead:**
- ‚úÖ Edit `src/modules/` components
- ‚úÖ Edit `src/components/` components
- ‚ùå Do NOT edit `app/` route files directly

### For Configuration
**Request manual change:**
- Configuration changes require developer approval
- Use Git workflow for config changes

## üõ°Ô∏è Security Enforcement

### IDE Level (Cursor)
- Cursor rules enforce this at edit time
- AI assistants blocked from writing outside `src/`

### MCP Level
- Filesystem MCP restricted to `src/`
- Next.js MCP restricted to `src/`
- All MCP servers validate paths

### Git Level
- Pre-commit hooks validate changes
- Only `src/` changes allowed in commits

## ‚ö†Ô∏è Error Messages

**When write is attempted outside `src/`:**
```
üî¥ FORBIDDEN: File write outside src/ directory
   Attempted: canon/A-Governance/ADR_003.md
   Allowed: Only files in src/ directory
   Action: Use .staging-docs/ workflow for canon files
```

## üìö Related Documents

- **REF_045_FileAccessControl.md** - Full access control documentation
- **REF_040_UnauditedDocsWorkflow.md** - Staging workflow for canon files
- **ADR_003_FileAccessControl.md** - Architecture decision (if created)

---

**Status:** üî¥ **ACTIVE ENFORCEMENT**  
**Last Updated:** 2025-01-27  
**Enforcement Level:** CRITICAL
