// ============================================================================
// MOCK METADATA DATABASE
// Sample data for development and testing
// ============================================================================

import type { MetadataRecord, AuditEntry } from '../types/metadata';

/**
 * Mock Metadata Records
 * Represents a sample data dictionary
 */
export const mockMetadataRecords: MetadataRecord[] = [
  {
    dict_id: 'DS-8821',
    business_term: 'Purchase Orders',
    technical_name: 'purchase_orders_main',
    version: '2.1.0',
    domain: 'Finance',
    entity_group: 'Transactional',
    tags: ['finance', 'procurement', 'erp'],
    canon_status: 'LOCKED',
    classification: 'INTERNAL',
    criticality: 'CRITICAL',
    data_owner: 'Alice Chen',
    data_steward: 'Bob Smith',
    definition_short: 'Master record of all purchase orders issued to vendors',
    definition_full: 'Complete purchase order records including line items, pricing, delivery terms, and approval workflows. Serves as the authoritative source for all procurement transactions.',
    calculation_logic: undefined,
    source_of_truth: 'SAP ERP',
    synonyms: ['PO', 'Purchase Requisitions', 'Vendor Orders'],
    data_type_biz: 'OBJECT',
    data_type_tech: 'TABLE',
    precision: undefined,
    nullability: false,
    format_pattern: undefined,
    valid_values: undefined,
    example_values: ['PO-2024-001234', 'PO-2024-001235'],
    edge_cases: ['Split orders', 'Cancelled POs', 'Multi-currency'],
    default_behaviour: 'New POs default to DRAFT status',
    default_interpretation: 'Null amount interpreted as $0.00',
    upstream_src: 'SAP_ERP_PROD',
    downstream_use: ['Finance_Reports', 'Audit_Dashboard', 'Vendor_Portal'],
    related_terms: ['DS-4429', 'DS-7743'],
    compliance_tags: ['SOX', 'GAAP'],
    approval_required: true,
    last_certified: '2024-12-01',
    recertification_due: '2025-06-01',
    errors_if_wrong: 'Revenue recognition errors, audit failures, vendor payment disputes',
    common_misuses: ['Using cancelled POs in reports', 'Ignoring multi-currency conversion'],
    created_at: '2023-11-15T10:30:00Z',
    updated_at: '2024-12-07T14:23:00Z',
    created_by: 'alice.chen@nexuscanon.io',
    updated_by: 'alice.chen@nexuscanon.io',
  },
  {
    dict_id: 'DS-4429',
    business_term: 'Invoices',
    technical_name: 'invoices_receivable',
    version: '1.8.2',
    domain: 'Finance',
    entity_group: 'Transactional',
    tags: ['finance', 'billing', 'accounts-receivable'],
    canon_status: 'PENDING',
    classification: 'CONFIDENTIAL',
    criticality: 'CRITICAL',
    data_owner: 'Bob Smith',
    data_steward: 'Carol Johnson',
    definition_short: 'Customer invoices for goods and services rendered',
    definition_full: 'Detailed invoice records including line items, tax calculations, payment terms, and collection status. Critical for revenue recognition and cash flow management.',
    calculation_logic: 'Total = SUM(line_items.amount) + TAX(total, tax_rate)',
    source_of_truth: 'Salesforce Billing',
    synonyms: ['Bills', 'AR Invoices', 'Customer Bills'],
    data_type_biz: 'OBJECT',
    data_type_tech: 'TABLE',
    precision: 'DECIMAL(18,2)',
    nullability: false,
    format_pattern: '^INV-\\d{4}-\\d{6}$',
    valid_values: undefined,
    example_values: ['INV-2024-000123', 'INV-2024-000124'],
    edge_cases: ['Credit notes', 'Partial payments', 'Currency conversion'],
    default_behaviour: 'New invoices default to UNPAID status',
    default_interpretation: 'Null payment date means invoice is outstanding',
    upstream_src: 'Salesforce_Billing_Cloud',
    downstream_use: ['Revenue_Reports', 'Cash_Flow_Forecast', 'Collections_Dashboard'],
    related_terms: ['DS-8821', 'DS-1092'],
    compliance_tags: ['SOX', 'GAAP', 'IFRS'],
    approval_required: true,
    last_certified: '2024-11-20',
    recertification_due: '2025-05-20',
    errors_if_wrong: 'Revenue misstatement, cash flow errors, customer disputes',
    common_misuses: ['Including cancelled invoices in revenue', 'Ignoring partial payments'],
    created_at: '2023-08-22T09:15:00Z',
    updated_at: '2024-12-05T09:14:00Z',
    created_by: 'bob.smith@nexuscanon.io',
    updated_by: 'carol.johnson@nexuscanon.io',
  },
  {
    dict_id: 'DS-1092',
    business_term: 'Transactions',
    technical_name: 'transactions_stream',
    version: '3.0.1',
    domain: 'Finance',
    entity_group: 'Event Stream',
    tags: ['finance', 'payments', 'real-time'],
    canon_status: 'LOCKED',
    classification: 'RESTRICTED',
    criticality: 'CRITICAL',
    data_owner: 'Carol Johnson',
    data_steward: 'Dave Martinez',
    definition_short: 'Real-time stream of all financial transactions',
    definition_full: 'High-frequency event stream capturing all monetary movements across accounts, including debits, credits, transfers, and adjustments. Serves as the immutable audit trail for all financial activity.',
    calculation_logic: undefined,
    source_of_truth: 'Payment_Gateway_API',
    synonyms: ['Payment Events', 'Ledger Entries', 'Financial Movements'],
    data_type_biz: 'ARRAY',
    data_type_tech: 'KAFKA_TOPIC',
    precision: 'DECIMAL(18,2)',
    nullability: false,
    format_pattern: undefined,
    valid_values: ['DEBIT', 'CREDIT', 'TRANSFER', 'ADJUSTMENT'],
    example_values: ['TXN-2024-12-07-0001234', 'TXN-2024-12-07-0001235'],
    edge_cases: ['Zero-amount transactions', 'Failed reversals', 'Cross-border fees'],
    default_behaviour: 'All transactions are immutable after creation',
    default_interpretation: 'Missing transaction = system failure, requires investigation',
    upstream_src: 'Stripe_Payment_Gateway',
    downstream_use: ['General_Ledger', 'Risk_Monitoring', 'Fraud_Detection'],
    related_terms: ['DS-4429', 'DS-8821'],
    compliance_tags: ['SOX', 'PCI-DSS', 'GAAP'],
    approval_required: false,
    last_certified: '2024-12-01',
    recertification_due: '2025-06-01',
    errors_if_wrong: 'Financial statement errors, compliance violations, fraud exposure',
    common_misuses: ['Modifying transaction records', 'Ignoring failed transactions'],
    created_at: '2023-05-10T14:00:00Z',
    updated_at: '2024-12-01T16:45:00Z',
    created_by: 'carol.johnson@nexuscanon.io',
    updated_by: 'dave.martinez@nexuscanon.io',
  },
  {
    dict_id: 'DS-7743',
    business_term: 'Customers',
    technical_name: 'customers_master',
    version: '1.5.0',
    domain: 'Operations',
    entity_group: 'Master Data',
    tags: ['crm', 'master-data', 'customer-360'],
    canon_status: 'CONFLICT',
    classification: 'CONFIDENTIAL',
    criticality: 'HIGH',
    data_owner: 'Dave Martinez',
    data_steward: 'Alice Chen',
    definition_short: 'Master customer registry with profiles and attributes',
    definition_full: 'Authoritative customer records including contact information, account history, preferences, and segmentation. Single source of truth for all customer-related data across systems.',
    calculation_logic: undefined,
    source_of_truth: 'Salesforce CRM',
    synonyms: ['Accounts', 'Customer Profiles', 'Client Records'],
    data_type_biz: 'OBJECT',
    data_type_tech: 'TABLE',
    precision: undefined,
    nullability: false,
    format_pattern: '^CUST-\\d{8}$',
    valid_values: undefined,
    example_values: ['CUST-00012345', 'CUST-00012346'],
    edge_cases: ['Duplicate records', 'Merged accounts', 'Inactive customers'],
    default_behaviour: 'New customers default to ACTIVE status',
    default_interpretation: 'Null contact info requires manual verification',
    upstream_src: 'Salesforce_CRM_Cloud',
    downstream_use: ['Marketing_Campaigns', 'Sales_Pipeline', 'Support_Tickets'],
    related_terms: ['DS-4429', 'DS-8821'],
    compliance_tags: ['GDPR', 'CCPA'],
    approval_required: true,
    last_certified: '2024-10-15',
    recertification_due: '2025-04-15',
    errors_if_wrong: 'Privacy violations, marketing errors, customer service failures',
    common_misuses: ['Using inactive records', 'Ignoring duplicate detection'],
    created_at: '2023-07-01T11:00:00Z',
    updated_at: '2024-11-28T11:02:00Z',
    created_by: 'dave.martinez@nexuscanon.io',
    updated_by: 'alice.chen@nexuscanon.io',
  },
  {
    dict_id: 'DS-3312',
    business_term: 'Product Catalog',
    technical_name: 'products_catalog',
    version: '2.3.1',
    domain: 'Operations',
    entity_group: 'Master Data',
    tags: ['products', 'inventory', 'pricing'],
    canon_status: 'LOCKED',
    classification: 'INTERNAL',
    criticality: 'HIGH',
    data_owner: 'Alice Chen',
    data_steward: 'Bob Smith',
    definition_short: 'Master product catalog with SKUs, pricing, and inventory',
    definition_full: 'Complete product information including SKUs, descriptions, pricing tiers, inventory levels, and supplier relationships. Supports multi-channel sales and inventory management.',
    calculation_logic: 'Effective_Price = Base_Price * (1 - Discount_Rate) + Tax',
    source_of_truth: 'NetSuite ERP',
    synonyms: ['SKU Master', 'Product Database', 'Item Registry'],
    data_type_biz: 'OBJECT',
    data_type_tech: 'TABLE',
    precision: 'DECIMAL(10,2)',
    nullability: false,
    format_pattern: '^SKU-[A-Z]{2}-\\d{6}$',
    valid_values: undefined,
    example_values: ['SKU-US-000123', 'SKU-UK-000456'],
    edge_cases: ['Discontinued products', 'Bundle pricing', 'Regional variations'],
    default_behaviour: 'New products default to INACTIVE until approved',
    default_interpretation: 'Null inventory count triggers reorder alert',
    upstream_src: 'NetSuite_ERP',
    downstream_use: ['Ecommerce_Site', 'POS_Systems', 'Inventory_Reports'],
    related_terms: ['DS-8821'],
    compliance_tags: ['SOX'],
    approval_required: true,
    last_certified: '2024-11-30',
    recertification_due: '2025-05-30',
    errors_if_wrong: 'Pricing errors, inventory discrepancies, order fulfillment failures',
    common_misuses: ['Using discontinued SKUs', 'Ignoring regional pricing'],
    created_at: '2023-09-12T13:45:00Z',
    updated_at: '2024-12-03T10:20:00Z',
    created_by: 'alice.chen@nexuscanon.io',
    updated_by: 'bob.smith@nexuscanon.io',
  },
];

/**
 * Mock Audit Trail
 * Sample audit history for metadata records
 */
export const mockAuditTrail: AuditEntry[] = [
  {
    timestamp: '2024-12-07T14:23:00Z',
    actor: 'Alice Chen',
    action: 'Updated schema',
    summary: 'Added 2 columns: delivery_date, shipping_method',
    fields_changed: ['data_type_tech', 'example_values'],
    dict_id: 'DS-8821',
  },
  {
    timestamp: '2024-12-05T09:14:00Z',
    actor: 'Bob Smith',
    action: 'Approved canon lock',
    summary: 'Reviewed and approved for production use',
    fields_changed: ['canon_status'],
    dict_id: 'DS-8821',
  },
  {
    timestamp: '2024-12-01T16:45:00Z',
    actor: 'Carol Johnson',
    action: 'Modified lineage mapping',
    summary: 'Added downstream dependency: Vendor_Portal',
    fields_changed: ['downstream_use'],
    dict_id: 'DS-8821',
  },
  {
    timestamp: '2024-11-28T11:02:00Z',
    actor: 'Alice Chen',
    action: 'Created dataset',
    summary: 'Initial creation of Purchase Orders metadata',
    fields_changed: [],
    dict_id: 'DS-8821',
  },
  {
    timestamp: '2024-12-05T09:14:00Z',
    actor: 'Carol Johnson',
    action: 'Updated calculation logic',
    summary: 'Modified tax calculation formula',
    fields_changed: ['calculation_logic'],
    dict_id: 'DS-4429',
  },
  {
    timestamp: '2024-11-20T15:30:00Z',
    actor: 'Bob Smith',
    action: 'Recertified',
    summary: 'Annual recertification completed',
    fields_changed: ['last_certified', 'recertification_due'],
    dict_id: 'DS-4429',
  },
];

/**
 * Helper function to get metadata by ID
 */
export function getMetadataById(id: string): MetadataRecord | undefined {
  return mockMetadataRecords.find((record) => record.dict_id === id);
}

/**
 * Helper function to get all metadata records
 */
export function getAllMetadata(): MetadataRecord[] {
  return mockMetadataRecords;
}

/**
 * Helper function to get audit trail for a specific metadata record
 */
export function getAuditTrailById(id: string): AuditEntry[] {
  return mockAuditTrail.filter((entry) => entry.dict_id === id);
}